@model List<E_Commerce_Web.Models.Product>

@{
    ViewBag.Title = "Shop";
    Layout = "~/Views/Shared/_Layout.cshtml";
}

<section id="page-header">
    <h2>#stayhome</h2>
    <p>Save more with coupons & up to 70% off!</p>
</section>

<section id="product1" class="section-p1">
    <div class="title-bar">
        <h2>All Products</h2>

        <select id="sortOptions" onchange="sortProducts(this)">
            <option value="priceAsc">Default Sorting</option>
            <option value="priceAsc">Sort by Price: Low to High</option>
            <option value="priceDesc">Sort by Price: High to Low</option>
            <option value="nameAsc">Sort by Name: A to Z</option>
            <option value="nameDesc">Sort by Name: Z to A</option>
            <option value="dateAsc">Sort by Date: Oldest to Newest</option>
            <option value="dateDesc">Sort by Date: Newest to Oldest</option>
        </select>
    </div>
    <div class="pro-container">
        @foreach (var product in Model)
        {
            <div class="pro" onclick="window.location.href='@Url.Action("ProductDetails", "Product", new { productId = product.ProductID })'">
                <img src="@Url.Content("~/Content/img/products/" + product.ImagePath)" alt="@product.ProductName">
                <div class="des">
                    <span>@product.Category.CategoryName</span>
                    <h5>@product.ProductName</h5>
                    <div class="star">
                        @for (int i = 0; i < 5; i++)
                        {
                            <i class="fas fa-star"></i>
                        }
                    </div>
                    <h4>@product.Price.ToString("C")</h4>
                </div>
                <a href="#"><i class="fal fa-shopping-cart cart"></i></a>
            </div>
        }
    </div>
</section>

<section id="pagination" class="section-p1">
    @if (ViewBag.CurrentPage > 1)
    {
        <a class="prev" href="@Url.Action("Shop", new { page = ViewBag.CurrentPage - 1 })"><i class="fal fa-long-arrow-alt-left"></i></a>
    }

    @{
        int startPage = Math.Max(1, ViewBag.CurrentPage - 1);
        int endPage = Math.Min(ViewBag.TotalPages, ViewBag.CurrentPage + 1);

        if (endPage - startPage < 2)
        {
            if (startPage == 1)
            {
                endPage = Math.Min(startPage + 2, ViewBag.TotalPages);
            }
            else if (endPage == ViewBag.TotalPages)
            {
                startPage = Math.Max(1, endPage - 2);
            }
        }
    }

    @for (int i = startPage; i <= endPage; i++)
    {
        <a class="@(i == ViewBag.CurrentPage ? "selected" : "")" href="@Url.Action("Shop", new { page = i })" class="@(i == ViewBag.CurrentPage ? "active" : "")">@i</a>
    }

    @if (ViewBag.CurrentPage < ViewBag.TotalPages)
    {
        <a href="@Url.Action("Shop", new { page = ViewBag.CurrentPage + 1 })"><i class="fal fa-long-arrow-alt-right"></i></a>
    }
</section>

<section id="newsletter" class="section-p1 section-m1">
    <div class="newstext">
        <h4>Sign Up For Newsletters</h4>
        <p>Get E-mail updates about our latest shop and <span>special offers.</span></p>
    </div>
    <div class="form">
        <input type="text" placeholder="Your email address">
        <button class="normal">Sign Up</button>
    </div>
</section>
